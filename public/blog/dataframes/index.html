<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.91.0" />
<title>Data frame wars: pandas vs. polars vs duckdb | Paul Simmering&#39;s blog</title>


<meta property="twitter:site" content="@paul_simmering">
<meta property="twitter:creator" content="@paul_simmering">







  
    
  
<meta name="description" content="A comparison of pandas, polars and duckdb from the perspective of a dplyr user.">


<meta property="og:site_name" content="Paul Simmering&#39;s blog">
<meta property="og:title" content="Data frame wars: pandas vs. polars vs duckdb | Paul Simmering&#39;s blog">
<meta property="og:description" content="A comparison of pandas, polars and duckdb from the perspective of a dplyr user." />
<meta property="og:type" content="page" />
<meta property="og:url" content="/blog/dataframes/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="/blog/dataframes/featured.jpg" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="/blog/dataframes/featured.jpg" >
    
    
  <meta itemprop="name" content="Data frame wars: pandas vs. polars vs duckdb">
<meta itemprop="description" content="I&rsquo;m a long time R user and lately I&rsquo;ve seen more and more signals that it&rsquo;s worth investing into learning more Python. I use it for NLP with spaCy and to build functions on AWS Lambda (though the recent lambdr package gave R some great tools there too). Further, there are many more data API libraries available for Python than for R.
The contenders     The first thing I needed was a way to manipulate data frames."><meta itemprop="datePublished" content="2021-12-20T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-12-20T00:00:00+00:00" />
<meta itemprop="wordCount" content="855"><meta itemprop="image" content="/blog/dataframes/featured.jpg">
<meta itemprop="keywords" content="Performance," />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.5477c20f89738a32763391bbc2f43dbdfc2db0e7faba550c86cac92c99efa6b6.css" integrity="sha256-VHfCD4lzijJ2M5G7wvQ9vfwtsOf6ulUMhsrJLJnvprY=" media="screen">
  
  
  <script src="/panelset.min.078a92db9bd3228df502db3d9e0453c3cf3d910abe3f8deca0ad196c7071ad41.js" type="text/javascript"></script>
  
  
  <script src="/main.min.ebeea774bd0288585efac7936c4997143f5f93209741bdc1e2efb2a12e19563d.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="/" title="Home">
      <img src="/img/blogophonic-mark-dark.png" class="dib db-l h2 w-auto" alt="Paul Simmering&#39;s blog">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About me">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/blog/" title="Blog">Blog</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/talk/" title="Talks">Talks</a>
      
      
      <div class="dib v-mid">
        <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/psimm" title="github" target="_blank" rel="noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://twitter.com/paul_simmering" title="twitter" target="_blank" rel="noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://de.linkedin.com/in/paulsimmering" title="linkedin" target="_blank" rel="noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
</div>

      </div>
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">Data frame wars: pandas vs. polars vs duckdb</h1>
        
        
        <p class="f7 db mv0 ttu">December 20, 2021</p>

      

      </header>
      <section class="post-body pt5 pb4">
        <p>I&rsquo;m a long time R user and lately I&rsquo;ve seen more and more signals that it&rsquo;s worth investing into learning more Python. I use it for NLP with 
<a href="https://spacy.io" target="_blank" rel="noopener">spaCy</a> and to build functions on 
<a href="https://aws.amazon.com/lambda/features/" target="_blank" rel="noopener">AWS Lambda</a> (though the recent 
<a href="https://mdneuzerling.com/post/serverless-on-demand-parametrised-r-markdown-reports-with-aws-lambda/" target="_blank" rel="noopener">lambdr</a> package gave R some great tools there too). Further, there are many more data API libraries available for Python than for R.</p>




<h2 id="the-contenders">The contenders
  <a href="#the-contenders"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>The first thing I needed was a way to manipulate data frames. I&rsquo;ve narrowed it down to 3 choices:</p>
<ul>
<li>
<a href="https://pandas.pydata.org" target="_blank" rel="noopener">Pandas</a>: The most commonly used library and the one with the most tutorials and Stack Overflow answers available.</li>
<li>
<a href="https://www.pola.rs" target="_blank" rel="noopener">Polars</a>: The fastest library available. It&rsquo;s a new library that doesn&rsquo;t have nearly as many users or help available. But according to the 
<a href="https://h2oai.github.io/db-benchmark/" target="_blank" rel="noopener">H2Oai ops benchmark</a>, it often runs 10x faster than Pandas.</li>
<li>
<a href="https://www.pola.rs" target="_blank" rel="noopener">Duckdb</a>: Use an in-memory OLAP database instead of a dataframe. I know SQL, so this is the easiest one to pick up.</li>
</ul>
<p>There are far more options and this is my shortlist. I have excluded the other options in the benchmark for these reasons:</p>
<ul>
<li>Less popular than pandas (meaning less help available)</li>
<li>Slower than polars (dask, Arrow, Modin)</li>
<li>Not mature enough, as shown by lower activity on Github (siuba, pydatatable)</li>
<li>Requires other software or a server (ClickHouse)</li>
<li>Not in Python (DataFrames.jl)</li>
<li>Meant for GPU only (cuDF)</li>
</ul>
<p>My reference is my current use of 
<a href="https://dplyr.tidyverse.org" target="_blank" rel="noopener">dplyr</a> in R. When I need more performance, I use 
<a href="https://github.com/markfairbanks/tidytable" target="_blank" rel="noopener">tidytable</a> to get the speed of data.table with the grammar of dplyr. I also use 
<a href="https://dbplyr.tidyverse.org" target="_blank" rel="noopener">dbplyr</a> a lot, which translates dplyr to SQL. It&rsquo;s composeable, which actually makes it superior to SQL for me in most use cases.</p>
<p>With that out of the way, here&rsquo;s a heavily biased comparison of the three Python packages.</p>
<p>I&rsquo;m speaking of my personal opinion of these packages given my own background - not a general comparison.</p>




<h2 id="pandas-most-popular">Pandas: Most popular
  <a href="#pandas-most-popular"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>The syntax is inspired by base R, which is a good thing.</p>
<p>Pandas uses a row index, which is basically a special blessed column. Base R also has this with row names, though the tidyverse and tibbles have largely removed them from common use.</p>
<p>Pandas has the widest API, offering hundreds of functions for every conceivable manipulation.</p>




<h2 id="polars-fastest">Polars: Fastest
  <a href="#polars-fastest"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>Polars is written in Rust and also offers a Python API. It comes in two flavors: eager and lazy. Lazy evaluation is similar to how dbplyr and dtplyer work: until asked, nothing is evaluated. This enables performance gains by reordering the commands being executed. But it&rsquo;s a little less convenient for interactive analysis.</p>
<p>The API is leaner than pandas, requiring to memorize fewer functions and patterns.</p>
<p>There isn&rsquo;t nearly as much help available for problems with polars as for with pandas. Often, I had to use trial and error based on the documentation. While the documentation is good, it can&rsquo;t answer every question.</p>




<h2 id="duckdb-easiest-for-sql-users">DuckDB: Easiest for SQL users
  <a href="#duckdb-easiest-for-sql-users"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>DuckDB can also operate directly on a pandas dataframe.</p>
<p>The performance is closer to polars than to pandas.</p>
<p>A big plus is the ability to handle larger than memory data.</p>
<p>The code is portable to R, C, C++, Java and other programming languages the duckdb has 
<a href="https://duckdb.org/docs/api/overview" target="_blank" rel="noopener">APIs</a>. It&rsquo;s also portable when the logic is taken to a DB like 
<a href="https://www.postgresql.org" target="_blank" rel="noopener">Postgres</a>, or 
<a href="https://www.snowflake.com/" target="_blank" rel="noopener">Snowflake</a>, or is ported to an ETL framework like 
<a href="https://github.com/dbt-labs/dbt-core" target="_blank" rel="noopener">DBT</a>.</p>
<p>This stands in contrast to polars and pandas code, which has to be rewritten from scratch. It also means that the skill gained in manipulating data translates well to other situations - SQL has been around for more than 40 years. Something that can&rsquo;t be said about any Python library. Learning SQL is future-proofing ones career.</p>
<p>While these are big plusses, duckdb isn&rsquo;t as convenient as Polars and Pandas for interactive data exploration. The SQL isn&rsquo;t as composable. Plus, writing strings rather than actual Python is awkward and many editors don&rsquo;t provide syntax highlighting within the strings (Jetbrains editors like 
<a href="https://www.jetbrains.com/pycharm/" target="_blank" rel="noopener">PyCharm</a> and 
<a href="https://www.jetbrains.com/dataspell/" target="_blank" rel="noopener">DataSpell</a> do).</p>
<p>SQL is less expressive than Python, especially when the names of output columns are unknown. It lacks shorthands.</p>
<p>It&rsquo;s also harder to write custom functions in SQL. With pandas and polars, custom operations are just one lambda away.</p>
<p>Using duckdb without pandas doesn&rsquo;t seem feasible for exploratory data analysis, because graphing packages like seaborn and plotly expect a pandas data frame or similar as an input.</p>
<p>Speed of iteration is critical: the faster one can iterate, the more hypotheses about the data can be tested.</p>




<h2 id="conclusion">Conclusion
  <a href="#conclusion"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>It&rsquo;s not a clear-cut choice. Each seems more useful in it&rsquo;s own arena.</p>
<p>None of the three options offer a syntax that is as convenient for interactive analysis as dplyr. Polars is the closest to it, but dplyr still has an edge with 
<a href="https://www.tidyverse.org/blog/2019/06/rlang-0-4-0/#a-simpler-interpolation-pattern-with" target="_blank" rel="noopener">tidy evaluation</a>, letting users refer to columns in a data frame by their names (<code>colname</code>) rather than as strings <code>&quot;colname&quot;</code>or constructs like <code>pl.col(&quot;colname&quot;)</code>. While this is nice for quickly writing code, I&rsquo;ve also seen it be confusing for newbies to R that mix it up with base R&rsquo;s syntax. It&rsquo;s also harder to program with, where it&rsquo;s necessary to use operators like <code>{{ }}</code> and <code>:=</code>.</p>
<p>Photo by <a href="https://unsplash.com/@hharritt?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Hunter Harritt</a> on <a href="https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a></p>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Posted on:</dt>
    <dd class="fw5 ml0">December 20, 2021</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Length:</dt>
    <dd class="fw5 ml0">5 minute read, 855 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categories:</dt>
    <dd class="fw5 ml0"> <a href="/categories/r">R</a>  <a href="/categories/python">Python</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="/tags/performance">Performance</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">See Also:</dt>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="/blog/echarts4r/">Exploring echarts4r &rarr;</a>
  
</div>

      </footer>
    </article>
    
      
<div class="post-comments pa0 pa4-l mt4">

</div>


    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2021 Paul Simmering, Germany
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/psimm" title="github" target="_blank" rel="noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://twitter.com/paul_simmering" title="twitter" target="_blank" rel="noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://de.linkedin.com/in/paulsimmering" title="linkedin" target="_blank" rel="noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/impressum/" title="Impressum">Impressum</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
